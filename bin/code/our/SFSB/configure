#!/bin/sh
rm -f *o genmatrix
HASHLEN=$1
cat > Makefile << EOF
CFLAGS:= -Wall -Wextra -Werror -pedantic -ansi -std=c99 -O3 -funroll-loops

sfsb: sfsb.o matrix.o
	gcc \$+ -o \$@

genmatrix: genmatrix.o ../pi.o
	gcc \$+ -o \$@

matrix.c: genmatrix
	./genmatrix > matrix.c

%.o: %.c params.h
	gcc \${CFLAGS} -Dhashlen=$HASHLEN -c \$< -o \$@

clean:
	rm -f *.o genmatrix Makefile matrix.c sfsb
EOF
