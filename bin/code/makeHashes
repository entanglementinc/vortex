#!/bin/bash
function zeroHashes()
{
	echo === $1 ===
	echo -n "L =    0: "
	echo -n "" | $2 | grep -Eo "\S*$"
	for i in $(seq 1 1023)
	do
		if [ $i -lt 10 ]; then
			echo -n "L =    $i: "
		elif [ $i  -lt 100 ]; then
			echo -n "L =   $i: "
		elif [ $i  -lt 1000 ]; then
			echo -n "L =  $i: "
		else
			echo -n "L = $i: "
		fi
		dd if=/dev/zero count=1 bs=$i 2> /dev/null | $2 | grep -Eo "\S*$"
	done
	echo ""
}
echo "Computing hashes..." >&2
(
echo "Hash values of 0-bit filled strings"
echo ""
zeroHashes "FSB-160"  "bin/fsb160"
zeroHashes "FSB-224"  "bin/fsb224"
zeroHashes "FSB-256"  "bin/fsb256"
zeroHashes "FSB-384"  "bin/fsb384"
zeroHashes "FSB-512"  "bin/fsb512"
zeroHashes "SFSB-160" "bin/sfsb160"
zeroHashes "SFSB-224" "bin/sfsb224"
zeroHashes "SFSB-384" "bin/sfsb384"
zeroHashes "RFSB-509" "bin/rfsb"
) > zeroHashes
(
echo "Hash values of 0-bit filled strings"
echo ""
echo "Computing reference hashes..." >&2
zeroHashes "FSB-160"  "ref/FSB/fsb -s 160"
zeroHashes "FSB-224"  "ref/FSB/fsb -s 224"
zeroHashes "FSB-256"  "ref/FSB/fsb -s 256"
zeroHashes "FSB-384"  "ref/FSB/fsb -s 384"
zeroHashes "FSB-512"  "ref/FSB/fsb -s 512"
zeroHashes "SFSB-160" "ref/SFSB/sfsb -s 160"
zeroHashes "SFSB-224" "ref/SFSB/sfsb -s 224"
zeroHashes "SFSB-384" "ref/SFSB/sfsb -s 384"
zeroHashes "RFSB-509" "ref/RFSB/rfsb"
) > refZeroHashes
if diff zeroHashes refZeroHashes > /dev/null
then
	rm refZeroHashes
	echo "Done"
else
	echo "Hashes mistmatch"
fi
